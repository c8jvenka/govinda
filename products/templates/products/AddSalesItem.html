{% include './MenuList.html' with menu="ls" %}

{% block content %}
<div class="col-sm-offset-7">
  <a type="button" class="btn btn-primary" href="{% url 'edit_cart' %}">Edit the Cart</a>
  <a type="button" class="btn btn-primary" href="{% url 'clear_cart' %}">Clear the Cart</a>

  <a type="button" class="btn btn-primary" href="{% url 'cart_checkout' %}" {% if not cart %} disabled {% endif %}>Check Out</a>

</div>

<h3>Cart Inventory Item</h3>

  <div class="container horizontal-scrollable"> 
    <div class="row text-center"> 
      <form class="form-horizontal" action="{% url 'edit_cart' %}" method="POST">
        {% csrf_token %}
      <table class="table table-bordered table-responsive table-striped">
        <thead>
          <tr>
            <th>Item code</th>
            <th>Item name</th>              
            <th>Order Quantity</th>
            <th>Price per Item</th>
            <th>Date</th>
            <th>Inventory Group</th>
            <th>Order Price</th>
      
        
          </tr>
        </thead>
        <tbody>
          {% if cart %}

              {% for item in cart %}
              
         <tr class="edit_order">
          <td><input class="form-control input-default" type="text" name="i_code" value="{{ item.item_code}}" readonly > </td>
          <td>{{ item.name}} </td>            
          <td>
            {{ item.order_quantity}}
          </td>
          <td>{{ item.item_price}} </td>
          <td>{{ item.date}}</td>
          <td>{{ item.item_group}} </td>
          <td>{{ item.order_price }} </td>
          {% if edit %}
          <td> <select class="form-control combo" id="order" name="order"/>
          </td>
          {% endif %}

        </tr>
              {% endfor %}    
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td><h3>Net Total :</h3></td>
          <td><h1>{{ total }}</h1></td>
          {% if edit %}
          <td>     <button type="submit" class="btn btn-primary" >Save Edit</button>
          </td>
          {% endif %}


        </tr>
        {% endif %}

        </tbody>
      </table>
      </form>
      
      </div></div>

      




<div class="col-sm-offset-0">
  <hr>
  
  <br>
  

<div class="container horizontal-scrollable"> 

  <div style="border-style:outset">

  <h3>Select Inventory by Filters</h3>
  <br>

        <div class="row text-center"> 
  

<form class="form-horizontal" action="{% url 'update_cart' %}" method="GET">
  {% csrf_token %}

  <div class="form-group">
    <label class="control-label col-sm-2" >Inventory Item Group:</label>
    <div class="col-xs-6">
      <select class="form-control" name="item_group">
        {% for h in ig %}
        <option>{{ h.name }}</option>
        {% endfor %}
        <option selected > </option>

    </select>
    </div>
    </div>

<div class="form-group">
<label class="control-label col-sm-2" >Inventory Item name contains :</label>
<div class="col-xs-6">
  <input type="text" class="form-control input-default " id="item_name" name="item_name" placeholder="Enter Inventory Item name" >
</div>        
</div>

<div class="form-group">
  <label class="control-label col-sm-2" >Inventory Item Code contains:</label>
  <div class="col-xs-6">
    <input type="text" class="form-control input-default" id="item_code" name="item_code" placeholder="Enter Inventory Item code" >
  </div>        
  </div>


<div class="form-group">        
<div class="col-sm-offset-2">

    <button type="submit" class="btn btn-primary"           {% if edit %}disabled {% endif %}    >Search</button>

  </div>
</div>

</form>
</div>
</div>
<hr> 
<br><br>



<form class="form-horizontal" action="{% url 'update_cart' %}" method="POST">
  {% csrf_token %}
<br>
<div class="form-group">        
  <div class="col-sm-offset-10">
  
        <button type="submit" class="btn btn-primary" {% if edit %} disabled {% endif %}>Add to Cart</button>
    
      </div>
</div>


  <table class="table table-bordered table-responsive table-striped">
  <thead>
    <tr>
      <th>Item code</th>
      <th>Item name</th>              
      <th>Available Quantity</th>
      <th>Price per Item</th>
      <th>Date Added</th>
      <th>Inventory Group</th>
      <th>Order Quantity</th>

  
    </tr>
  </thead>
  {% if qs %}
  <tbody>
        {% for item in qs %}
   <tr class="items">
   <td><input class="form-control input-default" type="text" name="i_code" value="{{ item.item_code}}" readonly {% if item.quantity < 1 %} disabled {% endif %}> </td>
    <td>{{ item.name}} </td>            
    <td>{{ item.quantity}} </td>
    <td>{{ item.price}} </td>
    <td>{{ item.date}} </td>
    <td>{{ item.group.name}} </td>
    
<td>
  <select class="form-control combo" id="order" name="order"	 {% if item.quantity < 1 %} disabled {% endif %}/>
</td>
  
  </tr>
        {% endfor %}    
  </tbody>
  
  {% endif %}
  
  </table>
</div>

  </form>
  </div> 
  
  <br><br><br><br>
  
  </div>
        




<script>
  $(document).ready(function(){
  
  $(".items").each(function(){
        var self = $(this);
        var j=self.find("td:eq(2)").text().trim();
          for(i=0;i<=j;i++){
            self.find("select").append('<option val=' + i + '>' + i + '</option>');
          }
  
  });
  
  $(".edit_order").each(function(){
        var self = $(this);
        var j=self.find("td:eq(2)").text().trim();
          for(i=0;i<=j;i++){
            self.find("select").append('<option>' + i + '</option>');
            if (i==j){ 
              self.find("select").val(i);
            };
          }
  
  });
    
  });
  
  </script>
    
{% endblock %}


